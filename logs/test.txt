[2025-04-26 01:06:06,241] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Warning: The cache directory for DeepSpeed Triton autotune, /root/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
INFO 04-26 01:06:07 __init__.py:183] Automatically detected platform cuda.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.73s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.21s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.29s/it]
Detected kernel version 5.4.143, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/100 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  1%|          | 1/100 [03:14<5:20:16, 194.10s/it]  2%|▏         | 2/100 [36:23<34:01:36, 1249.96s/it]  3%|▎         | 3/100 [1:08:50<42:15:13, 1568.18s/it]  4%|▍         | 4/100 [1:42:03<46:17:56, 1736.21s/it]  5%|▌         | 5/100 [2:15:13<48:13:46, 1827.65s/it]  6%|▌         | 6/100 [2:48:20<49:08:21, 1881.93s/it]  7%|▋         | 7/100 [2:56:40<36:56:40, 1430.11s/it]  8%|▊         | 8/100 [3:01:32<27:16:53, 1067.54s/it]  9%|▉         | 9/100 [3:10:12<22:39:55, 896.65s/it]  10%|█         | 10/100 [3:20:21<20:11:21, 807.58s/it]                                                       10%|█         | 10/100 [3:20:21<20:11:21, 807.58s/it] 11%|█         | 11/100 [3:53:33<28:55:41, 1170.13s/it] 12%|█▏        | 12/100 [3:57:06<21:29:07, 878.95s/it]  13%|█▎        | 13/100 [3:59:29<15:51:16, 656.05s/it] 14%|█▍        | 14/100 [4:32:40<25:18:30, 1059.42s/it] 15%|█▌        | 15/100 [4:45:58<23:08:54, 980.40s/it]  16%|█▌        | 16/100 [5:07:23<25:01:07, 1072.24s/it] 17%|█▋        | 17/100 [5:10:49<18:43:03, 811.84s/it]  18%|█▊        | 18/100 [5:17:24<15:37:59, 686.34s/it] 19%|█▉        | 19/100 [5:50:34<24:15:26, 1078.10s/it] 20%|██        | 20/100 [5:57:48<19:39:21, 884.52s/it]                                                        20%|██        | 20/100 [5:57:48<19:39:21, 884.52s/it]<string>:1: SyntaxWarning: 'int' object is not callable; perhaps you missed a comma?
 21%|██        | 21/100 [6:02:47<15:33:19, 708.85s/it] 22%|██▏       | 22/100 [6:35:46<23:37:15, 1090.20s/it] 23%|██▎       | 23/100 [6:45:41<20:08:01, 941.32s/it]  24%|██▍       | 24/100 [7:01:38<19:58:33, 946.23s/it] 25%|██▌       | 25/100 [7:04:32<14:53:16, 714.62s/it] 26%|██▌       | 26/100 [7:09:28<12:06:07, 588.75s/it] 27%|██▋       | 27/100 [7:18:51<11:47:01, 581.11s/it] 28%|██▊       | 28/100 [7:22:22<9:24:00, 470.01s/it]  29%|██▉       | 29/100 [7:30:41<9:26:40, 478.88s/it] 30%|███       | 30/100 [7:33:24<7:28:09, 384.14s/it]                                                      30%|███       | 30/100 [7:33:24<7:28:09, 384.14s/it] 31%|███       | 31/100 [8:06:35<16:36:09, 866.22s/it] 32%|███▏      | 32/100 [8:14:45<14:13:41, 753.25s/it] 33%|███▎      | 33/100 [8:47:56<20:55:40, 1124.49s/it] 34%|███▍      | 34/100 [9:01:47<19:00:11, 1036.54s/it] 35%|███▌      | 35/100 [9:35:00<23:53:37, 1323.35s/it] 36%|███▌      | 36/100 [10:08:13<27:06:03, 1524.43s/it] 37%|███▋      | 37/100 [10:41:29<29:09:07, 1665.84s/it] 38%|███▊      | 38/100 [11:14:43<30:23:01, 1764.21s/it] 39%|███▉      | 39/100 [11:47:53<31:02:40, 1832.14s/it] 40%|████      | 40/100 [11:53:36<23:05:20, 1385.33s/it]                                                         40%|████      | 40/100 [11:53:36<23:05:20, 1385.33s/it] 41%|████      | 41/100 [11:58:19<17:17:05, 1054.67s/it] 42%|████▏     | 42/100 [12:31:30<21:30:57, 1335.47s/it] 43%|████▎     | 43/100 [13:04:33<24:13:07, 1529.61s/it] 44%|████▍     | 44/100 [13:08:55<17:52:40, 1149.30s/it] 45%|████▌     | 45/100 [13:21:26<15:44:03, 1029.87s/it] 46%|████▌     | 46/100 [13:50:02<18:32:19, 1235.91s/it] 47%|████▋     | 47/100 [13:56:05<14:20:21, 973.99s/it]  48%|████▊     | 48/100 [14:00:31<10:59:58, 761.52s/it] 49%|████▉     | 49/100 [14:11:17<10:17:56, 727.00s/it] 50%|█████     | 50/100 [14:22:02<9:45:20, 702.41s/it]                                                        50%|█████     | 50/100 [14:22:02<9:45:20, 702.41s/it] 51%|█████     | 51/100 [14:55:16<14:49:59, 1089.79s/it] 52%|█████▏    | 52/100 [15:28:28<18:08:22, 1360.46s/it] 53%|█████▎    | 53/100 [16:01:38<20:13:33, 1549.22s/it] 54%|█████▍    | 54/100 [16:34:49<21:29:21, 1681.77s/it] 55%|█████▌    | 55/100 [16:44:03<16:47:38, 1343.52s/it] 56%|█████▌    | 56/100 [16:52:57<13:27:02, 1100.51s/it] 57%|█████▋    | 57/100 [17:26:09<16:20:23, 1367.99s/it] 58%|█████▊    | 58/100 [17:40:28<14:10:50, 1215.48s/it] 59%|█████▉    | 59/100 [18:13:29<16:27:21, 1444.90s/it] 60%|██████    | 60/100 [18:46:40<17:52:28, 1608.70s/it]                                                         60%|██████    | 60/100 [18:46:40<17:52:28, 1608.70s/it] 61%|██████    | 61/100 [18:53:19<13:29:50, 1245.90s/it] 62%|██████▏   | 62/100 [19:21:45<14:36:36, 1384.11s/it] 63%|██████▎   | 63/100 [19:27:10<10:57:25, 1066.10s/it] 64%|██████▍   | 64/100 [19:38:16<9:27:38, 946.06s/it]   65%|██████▌   | 65/100 [20:11:27<12:14:49, 1259.70s/it] 66%|██████▌   | 66/100 [20:44:41<13:58:36, 1479.90s/it] 67%|██████▋   | 67/100 [20:51:04<10:33:04, 1151.05s/it] 68%|██████▊   | 68/100 [20:56:38<8:03:08, 905.89s/it]   69%|██████▉   | 69/100 [21:19:12<8:57:24, 1040.14s/it] 70%|███████   | 70/100 [21:52:24<11:02:54, 1325.80s/it]                                                         70%|███████   | 70/100 [21:52:24<11:02:54, 1325.80s/it] 71%|███████   | 71/100 [22:02:27<8:55:57, 1108.88s/it]  72%|███████▏  | 72/100 [22:35:39<10:41:08, 1373.88s/it] 73%|███████▎  | 73/100 [23:08:46<11:41:01, 1557.82s/it] 74%|███████▍  | 74/100 [23:18:44<9:10:17, 1269.91s/it]  75%|███████▌  | 75/100 [23:25:22<7:00:05, 1008.23s/it] 76%|███████▌  | 76/100 [23:58:31<8:40:57, 1302.39s/it] 77%|███████▋  | 77/100 [24:31:40<9:38:13, 1508.40s/it] 78%|███████▊  | 78/100 [24:37:29<7:05:32, 1160.55s/it] 79%|███████▉  | 79/100 [24:41:42<5:10:58, 888.50s/it]  80%|████████  | 80/100 [25:14:51<6:46:14, 1218.70s/it]                                                        80%|████████  | 80/100 [25:14:51<6:46:14, 1218.70s/it] 81%|████████  | 81/100 [25:48:01<7:39:07, 1449.85s/it] 82%|████████▏ | 82/100 [25:53:29<5:34:02, 1113.46s/it] 83%|████████▎ | 83/100 [26:26:39<6:29:57, 1376.30s/it] 84%|████████▍ | 84/100 [26:33:05<4:47:50, 1079.41s/it] 85%|████████▌ | 85/100 [27:06:16<5:38:10, 1352.69s/it] 86%|████████▌ | 86/100 [27:10:34<3:59:01, 1024.40s/it] 87%|████████▋ | 87/100 [27:14:56<2:52:24, 795.71s/it]  88%|████████▊ | 88/100 [27:47:33<3:48:47, 1143.99s/it] 89%|████████▉ | 89/100 [28:20:44<4:16:18, 1398.00s/it] 90%|█████████ | 90/100 [28:28:02<3:05:01, 1110.14s/it]                                                        90%|█████████ | 90/100 [28:28:02<3:05:01, 1110.14s/it] 91%|█████████ | 91/100 [28:35:45<2:17:23, 915.93s/it]  92%|█████████▏| 92/100 [28:42:29<1:41:39, 762.43s/it] 93%|█████████▎| 93/100 [29:10:42<2:01:31, 1041.59s/it] 94%|█████████▍| 94/100 [29:14:08<1:19:05, 790.83s/it]  95%|█████████▌| 95/100 [29:22:55<59:17, 711.60s/it]   96%|█████████▌| 96/100 [29:56:05<1:13:01, 1095.37s/it] 97%|█████████▋| 97/100 [30:06:37<47:48, 956.13s/it]    98%|█████████▊| 98/100 [30:19:54<30:16, 908.43s/it] 99%|█████████▉| 99/100 [30:53:05<20:33, 1233.24s/it]100%|██████████| 100/100 [31:26:18<00:00, 1461.07s/it]                                                      100%|██████████| 100/100 [31:26:18<00:00, 1461.07s/it]                                                      100%|██████████| 100/100 [31:26:18<00:00, 1461.07s/it]100%|██████████| 100/100 [31:26:18<00:00, 1131.78s/it]
{'loss': 0.0, 'grad_norm': 0.00011547317990334705, 'learning_rate': 4.877641290737883e-07, 'completion_length': 275.5333419799805, 'rewards/format_reward_func': 0.08888889029622078, 'rewards/equation_reward_func': 0.0, 'reward': 0.08888889029622078, 'reward_std': 0.15396007150411606, 'kl': 0.0012440810853149742, 'epoch': 0.01}
{'loss': 0.0, 'grad_norm': 9.050148946698755e-05, 'learning_rate': 4.5225424859373684e-07, 'completion_length': 239.51111526489257, 'rewards/format_reward_func': 0.0555555559694767, 'rewards/equation_reward_func': 0.0, 'reward': 0.0555555559694767, 'reward_std': 0.09622504562139511, 'kl': 0.001734788529574871, 'epoch': 0.01}
{'loss': 0.0, 'grad_norm': 0.00017036381177604198, 'learning_rate': 3.9694631307311825e-07, 'completion_length': 217.13333740234376, 'rewards/format_reward_func': 0.04444444477558136, 'rewards/equation_reward_func': 0.0, 'reward': 0.04444444477558136, 'reward_std': 0.07698003649711609, 'kl': 0.001930661138612777, 'epoch': 0.02}
{'loss': 0.0, 'grad_norm': 0.5572826862335205, 'learning_rate': 3.272542485937368e-07, 'completion_length': 261.1999969482422, 'rewards/format_reward_func': 0.04444444477558136, 'rewards/equation_reward_func': 0.0, 'reward': 0.04444444477558136, 'reward_std': 0.07698003649711609, 'kl': 0.0014040019712410867, 'epoch': 0.03}
{'loss': 0.0, 'grad_norm': 0.00021327102149371058, 'learning_rate': 2.5e-07, 'completion_length': 208.3777816772461, 'rewards/format_reward_func': 0.08888889029622078, 'rewards/equation_reward_func': 0.0, 'reward': 0.08888889029622078, 'reward_std': 0.13471506386995316, 'kl': 0.0017229765304364263, 'epoch': 0.03}
{'loss': 0.0, 'grad_norm': 0.4890645742416382, 'learning_rate': 1.7274575140626315e-07, 'completion_length': 274.9777770996094, 'rewards/format_reward_func': 0.08888888955116273, 'rewards/equation_reward_func': 0.0, 'reward': 0.08888888955116273, 'reward_std': 0.15396007299423217, 'kl': 0.0014220805489458144, 'epoch': 0.04}
{'loss': 0.0, 'grad_norm': 0.20783771574497223, 'learning_rate': 1.0305368692688174e-07, 'completion_length': 251.47777709960937, 'rewards/format_reward_func': 0.06666666716337204, 'rewards/equation_reward_func': 0.0, 'reward': 0.06666666716337204, 'reward_std': 0.11547005474567414, 'kl': 0.0014072220656089485, 'epoch': 0.05}
{'loss': 0.0, 'grad_norm': 0.0006816451204940677, 'learning_rate': 4.774575140626316e-08, 'completion_length': 274.8999984741211, 'rewards/format_reward_func': 0.1222222238779068, 'rewards/equation_reward_func': 0.0, 'reward': 0.1222222238779068, 'reward_std': 0.17320508062839507, 'kl': 0.0016633209597785026, 'epoch': 0.05}
{'loss': 0.0, 'grad_norm': 0.00011742638889700174, 'learning_rate': 1.2235870926211616e-08, 'completion_length': 252.73333435058595, 'rewards/format_reward_func': 0.03333333358168602, 'rewards/equation_reward_func': 0.0, 'reward': 0.03333333358168602, 'reward_std': 0.05773502737283707, 'kl': 0.0014148981194011868, 'epoch': 0.06}
{'loss': 0.0, 'grad_norm': 0.2295749932527542, 'learning_rate': 0.0, 'completion_length': 271.67777862548826, 'rewards/format_reward_func': 0.08888888955116273, 'rewards/equation_reward_func': 0.0, 'reward': 0.08888888955116273, 'reward_std': 0.13471506237983705, 'kl': 0.001561982516432181, 'epoch': 0.07}
{'train_runtime': 113178.3303, 'train_samples_per_second': 0.003, 'train_steps_per_second': 0.001, 'train_loss': 1.5560074825771154e-06, 'epoch': 0.07}
